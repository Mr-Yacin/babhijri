---
import AdminLayout from "../../../layouts/AdminLayout.astro";
import AdminCheck from "../../../components/admin/AdminCheck.astro";
---

<AdminLayout title="ุฅุถุงูุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ">
    <AdminCheck />

    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-slate-900 mb-2">
                ุฅุถุงูุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ
            </h1>
            <p class="text-slate-500">
                ุชูููุฏ ูููุงุช ุดุฎุตูุฉ ุนุดูุงุฆูุฉ ูุงุฎุชุจุงุฑ ุงูุชุทุจูู. ููููู ุฅุถุงูุฉ ุงููุฒูุฏ ูู
                ุงููููุงุช ูู ุฃู ููุช.
            </p>
        </div>

        <!-- Info Banner -->
        <div
            class="bg-blue-50 border border-blue-100 rounded-2xl p-6 mb-8 flex items-start gap-4"
        >
            <div
                class="w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0 text-blue-600"
            >
                <span class="text-xl">โน๏ธ</span>
            </div>
            <div>
                <h3 class="font-bold text-blue-900 mb-1">
                    ููู ุชุนูู ูุฐู ุงูุฃุฏุงุฉุ
                </h3>
                <p class="text-sm text-blue-800/80 leading-relaxed">
                    ุณุชููู ูุฐู ุงูุฃุฏุงุฉ ุจุชูููุฏ 20 ููููุง ุดุฎุตููุง ุฌุฏูุฏูุง ุจุจูุงูุงุช
                    ุนุดูุงุฆูุฉ (ุฃุณูุงุกุ ุตูุฑุ ุชูุงุตูู) ูู ูู ูุฑุฉ ุชุถุบุท ูููุง ุนูู ุงูุฒุฑ.
                    ุณูุชู ุฅูุดุงุก ูุนุฑูุงุช ูุฑูุฏุฉ ููู ููู ุจุตูุบุฉ <code
                        class="bg-blue-100 px-1 py-0.5 rounded text-blue-900 text-xs"
                        >profile_xxxxxxxx</code
                    >.
                </p>
            </div>
        </div>

        <!-- Seeding Card -->
        <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-8">
            <!-- Start Button -->
            <div class="flex flex-col items-center justify-center mb-8">
                <button
                    id="start-seed-btn"
                    class="group relative px-8 py-4 bg-teal-600 text-white font-bold rounded-xl hover:bg-teal-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-all shadow-lg hover:shadow-teal-500/30 hover:-translate-y-0.5 overflow-hidden"
                >
                    <div
                        class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"
                    >
                    </div>
                    <span class="relative flex items-center gap-3 text-lg">
                        <span class="text-2xl">๐ฑ</span>
                        <span>ุชูููุฏ 20 ููู ุดุฎุตู</span>
                    </span>
                </button>
                <p class="mt-3 text-xs text-slate-400">
                    ุงุถุบุท ูุฑุฉ ุฃุฎุฑู ูุฅุถุงูุฉ ุงููุฒูุฏ
                </p>
            </div>

            <!-- Progress Bar -->
            <div
                class="mb-8 bg-slate-50 rounded-xl p-4 border border-slate-100"
            >
                <div class="flex justify-between mb-2">
                    <span class="text-sm font-medium text-slate-700"
                        >ุญุงูุฉ ุงูุนูููุฉ</span
                    >
                    <span
                        id="progress-text"
                        class="text-sm font-bold text-teal-600">0%</span
                    >
                </div>
                <div
                    class="w-full bg-slate-200 rounded-full h-3 overflow-hidden"
                >
                    <div
                        id="progress-bar"
                        class="bg-gradient-to-r from-teal-500 to-teal-400 h-3 rounded-full transition-all duration-300 shadow-[0_0_10px_rgba(20,184,166,0.5)]"
                        style="width:0%"
                    >
                    </div>
                </div>
                <div
                    id="status-message"
                    class="text-center text-sm text-slate-500 mt-3 min-h-[20px]"
                >
                    ุฌุงูุฒ ููุจุฏุก...
                </div>
            </div>

            <!-- Results List -->
            <div
                class="border border-slate-200 rounded-xl overflow-hidden bg-white"
            >
                <div
                    class="bg-slate-50 px-4 py-3 border-b border-slate-200 flex justify-between items-center"
                >
                    <h3 class="font-semibold text-slate-700 text-sm">
                        ุณุฌู ุงููุชุงุฆุฌ
                    </h3>
                    <span
                        id="count-badge"
                        class="bg-slate-200 text-slate-600 text-xs px-2 py-1 rounded-full hidden"
                        >0</span
                    >
                </div>
                <div
                    class="max-h-64 overflow-y-auto p-4 custom-scrollbar bg-slate-50/50"
                >
                    <ul id="results-list" class="space-y-2">
                        <li
                            class="text-slate-400 text-sm text-center py-8 flex flex-col items-center gap-2"
                        >
                            <span class="text-2xl opacity-50">๐</span>
                            <span>ุงููุชุงุฆุฌ ุณุชุธูุฑ ููุง...</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        import { db } from "../../../lib/firebase";
        import { doc, setDoc, Timestamp } from "firebase/firestore";

        // Data Arrays for Random Generation
        const FIRST_NAMES_MALE = [
            "ุฃุญูุฏ",
            "ูุญูุฏ",
            "ููุณู",
            "ุนูุฑ",
            "ุนูู",
            "ุฎุงูุฏ",
            "ุฅุจุฑุงููู",
            "ุญุณู",
            "ุญุณูู",
            "ุนุจุฏุงููู",
            "ุณุนูุฏ",
            "ูุงุฌุฏ",
            "ููุฏ",
            "ุณููุงู",
            "ูุงูู",
            "ุขุฏู",
            "ููุญ",
            "ูููุณ",
            "ุฒูุฑูุง",
            "ูุญูู",
        ];
        const FIRST_NAMES_FEMALE = [
            "ุณุงุฑุฉ",
            "ููุฑุฉ",
            "ูุงุทูุฉ",
            "ูุฑูู",
            "ุนุงุฆุดุฉ",
            "ุฒููุจ",
            "ูููู",
            "ููุฏ",
            "ุฃูู",
            "ููู",
            "ุณููู",
            "ุฑูู",
            "ุฌูุงูุฑ",
            "ูุทููุฉ",
            "ุญุตุฉ",
            "ููุฑ",
            "ุฌูู",
            "ุญูุง",
            "ููู",
            "ูุงูุง",
        ];
        const LAST_NAMES = [
            "ุงูุบุงูุฏู",
            "ุงูุนุชูุจู",
            "ุงููุญุทุงูู",
            "ุงูุดูุฑู",
            "ุงูุฏูุณุฑู",
            "ุงูุฒูุฑุงูู",
            "ุงูุดูุฑู",
            "ุงูุญุฑุจู",
            "ุงููุทูุฑู",
            "ุงูุณุจูุนู",
            "ุงููุงููู",
            "ุงูุนูุฑู",
            "ุงููุงูู",
            "ุงูุนูุฒู",
            "ุงูุฑุดูุฏู",
            "ุงูุฃุญูุฏ",
            "ุงููุญูุฏ",
            "ุงูููุณู",
            "ุงูุนูู",
            "ุงูุญุณู",
        ];

        // Diverse Locations Mapping
        const LOCATIONS: Record<string, string[]> = {
            "ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ": [
                "ุงูุฑูุงุถ",
                "ุฌุฏุฉ",
                "ููุฉ ุงูููุฑูุฉ",
                "ุงููุฏููุฉ ุงููููุฑุฉ",
                "ุงูุฏูุงู",
                "ุงูุฎุจุฑ",
                "ุชุจูู",
                "ุฃุจูุง",
            ],
            ูุตุฑ: [
                "ุงููุงูุฑุฉ",
                "ุงูุฅุณููุฏุฑูุฉ",
                "ุงูุฌูุฒุฉ",
                "ุดุฑู ุงูุดูุฎ",
                "ุงูุฃูุตุฑ",
                "ุฃุณูุงู",
                "ุงูููุตูุฑุฉ",
            ],
            ุงูุฅูุงุฑุงุช: ["ุฏุจู", "ุฃุจู ุธุจู", "ุงูุดุงุฑูุฉ", "ุนุฌูุงู", "ุฑุฃุณ ุงูุฎููุฉ"],
            ุงููุบุฑุจ: [
                "ุงูุฏุงุฑ ุงูุจูุถุงุก",
                "ุงูุฑุจุงุท",
                "ูุฑุงูุด",
                "ูุงุณ",
                "ุทูุฌุฉ",
                "ุฃุบุงุฏูุฑ",
            ],
            ุงูุฌุฒุงุฆุฑ: ["ุงูุฌุฒุงุฆุฑ ุงูุนุงุตูุฉ", "ููุฑุงู", "ูุณูุทููุฉ", "ุนูุงุจุฉ"],
            ุชููุณ: ["ุชููุณ ุงูุนุงุตูุฉ", "ุตูุงูุณ", "ุณูุณุฉ"],
            ุงูุฃุฑุฏู: ["ุนูุงู", "ุฅุฑุจุฏ", "ุงูุฒุฑูุงุก", "ุงูุนูุจุฉ"],
            ูุฑูุณุง: ["ุจุงุฑูุณ", "ูููู", "ูุงุฑุณูููุง", "ููุณ", "ุชูููุฒ"],
            ุฃููุงููุง: ["ุจุฑููู", "ููููุฎ", "ูุงูุจูุฑุบ", "ูุฑุงููููุฑุช", "ููููููุง"],
            ุจุฑูุทุงููุง: ["ููุฏู", "ูุงูุดุณุชุฑ", "ุจุฑููุบูุงู", "ูููุฑุจูู", "ุฅุฏูุจุฑุฉ"],
            "ุงูููุงูุงุช ุงููุชุญุฏุฉ": [
                "ูููููุฑู",
                "ููุณ ุฃูุฌููุณ",
                "ุดููุงุบู",
                "ูููุณุชู",
                "ููุงูู",
                "ูุงุดูุทู",
            ],
            ููุฏุง: ["ุชูุฑููุชู", "ูููุชุฑูุงู", "ูุงููููุฑ", "ุฃูุชุงูุง", "ูุงูุฌุงุฑู"],
            ุชุฑููุง: ["ุฅุณุทูุจูู", "ุฃููุฑุฉ", "ุฅุฒููุฑ", "ุฃูุทุงููุง", "ุจูุฑุตุฉ"],
            ุฅุณุจุงููุง: ["ูุฏุฑูุฏ", "ุจุฑุดูููุฉ", "ูุงููุณูุง", "ุฅุดุจูููุฉ"],
        };

        const JOBS = [
            "ูููุฏุณ",
            "ุทุจูุจ",
            "ูุนูู",
            "ูุจุฑูุฌ",
            "ูุญุงุณุจ",
            "ูุฏูุฑ ุฃุนูุงู",
            "ููุธู ุญูููู",
            "ุฑุงุฆุฏ ุฃุนูุงู",
            "ุตูุฏูู",
            "ููุฑุถ",
            "ุถุงุจุท",
            "ูุญุงูู",
            "ูุตูู ุฌุฑุงููู",
            "ูุงุชุจ",
            "ูุชุฑุฌู",
            "ุทุงูุจ",
            "ุจุงุญุซ",
            "ุฃุณุชุงุฐ ุฌุงูุนู",
        ];
        const BIOS = [
            "ุฃุจุญุซ ุนู ุดุฑูู ุญูุงุฉ ูุดุงุฑููู ุทููุญุงุชู ูุฃุญูุงูู.",
            "ุฅูุณุงู ูุงุฏุฆ ููุญุจ ููุญูุงุฉ ุงูุนุงุฆููุฉ.",
            "ุฃุญุจ ุงูุณูุฑ ูุงููุฑุงุกุฉ ูุงูุชุนุฑู ุนูู ุซูุงูุงุช ุฌุฏูุฏุฉ.",
            "ุฌุงุฏ ูู ููุถูุน ุงูุฒูุงุฌ ูุฃุจุญุซ ุนู ุงูุงุณุชูุฑุงุฑ.",
            "ุฃูุฏุฑ ุงูุตุฏู ูุงูุงุญุชุฑุงู ุงููุชุจุงุฏู ูู ุงูุนูุงูุงุช.",
            "ุทููุญ ูุฃุณุนู ูุชุทููุฑ ููุณู ุจุงุณุชูุฑุงุฑ.",
            "ุฃุญุจ ุงูุทุจูุนุฉ ูุงููุฏูุก ูุงูุนูุด ุจุจุณุงุทุฉ.",
            "ุดุฎุตูุฉ ูุฑุญุฉ ููุชูุงุฆูุฉุ ุฃุญุจ ุงูุญูุงุฉ ูุฃุจุญุซ ุนู ุงูุณุนุงุฏุฉ.",
            "ุฃุจุญุซ ุนู ุงููุตู ุงูุขุฎุฑ ุงูุฐู ูููููู.",
            "ููุชู ุจุงููููู ูุงูุซูุงูุฉ ูุฃุจุญุซ ุนู ุดุฎุต ูุดุงุฑููู ุงูุชูุงูุงุชู.",
        ];
        const INTERESTS = [
            "ุงูุณูุฑ",
            "ุงููุฑุงุกุฉ",
            "ุงูุฑูุงุถุฉ",
            "ุงูุทุจุฎ",
            "ุงูุชุตููุฑ",
            "ุงูุฑุณู",
            "ุงูููุณููู",
            "ุงูุชุทูุน",
            "ุงูุชูููุฉ",
            "ุงูุชุฌุงุฑุฉ",
            "ุงูุณุจุงุญุฉ",
            "ุงููุดู",
            "ุงูุชุณูู",
            "ุงูุฃูุนุงุจ",
            "ุงูุณูููุง",
            "ุงููุณุฑุญ",
            "ุงููุชุงุจุฉ",
        ];
        const LANGUAGES = [
            "ุงูุนุฑุจูุฉ",
            "ุงูุฅูุฌููุฒูุฉ",
            "ุงููุฑูุณูุฉ",
            "ุงูุฅุณุจุงููุฉ",
            "ุงูุชุฑููุฉ",
            "ุงูุฃููุงููุฉ",
            "ุงูุฅูุทุงููุฉ",
            "ุงูุฑูุณูุฉ",
        ];

        function getRandomElement(arr: any[]) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        function getRandomElements(arr: any[], count: number) {
            const shuffled = arr.sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }

        function generateRandomId() {
            return "profile_" + Math.random().toString(36).substr(2, 9);
        }

        function generateRandomProfile() {
            const isMale = Math.random() > 0.5;
            const firstName = isMale
                ? getRandomElement(FIRST_NAMES_MALE)
                : getRandomElement(FIRST_NAMES_FEMALE);
            const lastName = getRandomElement(LAST_NAMES);
            const gender = isMale ? "male" : "female";

            // Generate email from name
            const emailName = `${firstName}.${lastName}`
                .replace(/[^a-zA-Z0-9]/g, "")
                .toLowerCase();
            const emailPrefix = `user_${Math.random().toString(36).substr(2, 8)}`;
            const email = `${emailPrefix}@example.com`;

            // Generate a random age between 20 and 45
            const age = Math.floor(Math.random() * 25) + 20;
            const birthYear = new Date().getFullYear() - age;
            const birthDate = new Date(
                birthYear,
                Math.floor(Math.random() * 12),
                Math.floor(Math.random() * 28) + 1,
            );

            // Generate photo URL (using randomuser.me)
            const photoGender = isMale ? "men" : "women";
            const photoId = Math.floor(Math.random() * 99);
            const photoUrl = `https://randomuser.me/api/portraits/${photoGender}/${photoId}.jpg`;

            // Select random country and city
            const countries = Object.keys(LOCATIONS);
            const country = getRandomElement(countries);
            const cities = LOCATIONS[country];
            const city = getRandomElement(cities);

            return {
                uid: generateRandomId(),
                displayName: `${firstName} ${lastName}`,
                email: email,
                gender: gender,
                age: age,
                birthDate: Timestamp.fromDate(birthDate),
                city: city,
                country: country,
                location: `${city}, ${country}`,
                occupation: getRandomElement(JOBS),
                bio: getRandomElement(BIOS),
                maritalStatus: getRandomElement([
                    "single",
                    "divorced",
                    "widowed",
                ]),
                education: getRandomElement([
                    "bachelors",
                    "masters",
                    "phd",
                    "high_school",
                ]),
                height: Math.floor(Math.random() * 40) + 150, // 150-190
                weight: Math.floor(Math.random() * 50) + 50, // 50-100
                prayer: getRandomElement([
                    "always",
                    "sometimes",
                    "friday_only",
                ]),
                hijab: !isMale
                    ? getRandomElement(["hijab", "niqab", "none"])
                    : null,
                beard: isMale
                    ? getRandomElement(["beard", "light_beard", "none"])
                    : null,
                smoking: getRandomElement(["no", "sometimes", "yes"]),
                photos: [photoUrl],
                interests: getRandomElements(INTERESTS, 3),
                languages: getRandomElements(LANGUAGES, 2),
                isVisible: true,
                isVerified: Math.random() > 0.7,
                createdAt: Timestamp.now(),
                updatedAt: Timestamp.now(),
                isActive: true,
            };
        }

        const startBtn = document.getElementById(
            "start-seed-btn",
        ) as HTMLButtonElement;
        const statusDiv = document.getElementById("status-message");
        const progressBar = document.getElementById("progress-bar");
        const progressText = document.getElementById("progress-text");
        const resultsList = document.getElementById("results-list");
        const countBadge = document.getElementById("count-badge");

        if (startBtn) {
            startBtn.addEventListener("click", async () => {
                // Confirm dialog
                if (!confirm("โ๏ธ ูู ุฃูุช ูุชุฃูุฏ ูู ุฅุถุงูุฉ 20 ููู ุดุฎุตู ุฌุฏูุฏุ")) {
                    return;
                }

                // Reset UI
                startBtn.disabled = true;
                if (statusDiv)
                    statusDiv.textContent = "โณ ุฌุงุฑู ุงูุชูููุฏ ูุงูุฅุถุงูุฉ...";
                if (statusDiv)
                    statusDiv.className =
                        "text-center text-sm text-blue-600 mt-3 font-medium animate-pulse";
                if (resultsList) resultsList.innerHTML = "";
                if (countBadge) countBadge.classList.remove("hidden");

                let successCount = 0;
                const TOTAL_TO_ADD = 20;

                for (let i = 0; i < TOTAL_TO_ADD; i++) {
                    const profile = generateRandomProfile();
                    const progress = Math.round(((i + 1) / TOTAL_TO_ADD) * 100);

                    // Update Progress
                    if (progressBar) progressBar.style.width = `${progress}%`;
                    if (progressText) progressText.textContent = `${progress}%`;

                    try {
                        await setDoc(doc(db, "profiles", profile.uid), profile);

                        successCount++;
                        if (countBadge)
                            countBadge.textContent = successCount.toString();

                        // Add to list
                        const li = document.createElement("li");
                        li.className =
                            "flex items-center gap-3 text-sm text-slate-700 bg-white p-3 rounded-lg border border-slate-100 shadow-sm animate-fade-in";
                        li.innerHTML = `
                            <img src="${profile.photos[0]}" class="w-8 h-8 rounded-full object-cover border border-slate-200" alt="${profile.displayName}">
                            <div class="flex-1">
                                <span class="font-bold text-slate-900">${profile.displayName}</span>
                                <span class="text-xs text-slate-400 mx-2">${profile.uid}</span>
                            </div>
                            <span class="text-xs bg-slate-100 px-2 py-1 rounded text-slate-500">${profile.city}, ${profile.country}</span>
                        `;
                        resultsList?.insertBefore(li, resultsList.firstChild);
                    } catch (error) {
                        console.error("Error adding profile:", error);
                        const li = document.createElement("li");
                        li.className =
                            "flex items-center gap-3 text-sm text-red-700 bg-red-50 p-3 rounded-lg border border-red-100";
                        li.innerHTML = `<span class="font-bold">โ</span> <span>ูุดู ุฅุถุงูุฉ ุงูููู</span>`;
                        resultsList?.insertBefore(li, resultsList.firstChild);
                    }

                    // Small delay for visual effect
                    await new Promise((r) => setTimeout(r, 100));
                }

                // Final State
                if (statusDiv) {
                    statusDiv.textContent = `โจ ุชู ุจูุฌุงุญ! ุชูุช ุฅุถุงูุฉ ${successCount} ูููุงุช ุฌุฏูุฏุฉ.`;
                    statusDiv.className =
                        "text-center text-sm text-green-600 mt-3 font-bold";
                }

                startBtn.disabled = false;
                startBtn.innerHTML = `
                    <span class="relative flex items-center gap-3 text-lg">
                        <span class="text-2xl">๐</span>
                        <span>ุฅุถุงูุฉ ุงููุฒูุฏ</span>
                    </span>
                `;
            });
        }
    </script>
</AdminLayout>
