---
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/common/Header.astro";
import Footer from "../../components/common/Footer.astro";
import AdUnit from "../../components/ads/AdUnit.astro";
import DismissableAd from "../../components/ads/DismissableAd.svelte";
import { SITE_CONFIG, ANALYTICS_CONFIG } from "../../config";
import MessagesApp from "../../components/messaging/MessagesApp.svelte";
---

<Layout title={`الرسائل | ${SITE_CONFIG.name}`}>
    <Header />

    <main class="min-h-screen bg-gray-50">
        <!-- Page Header -->
        <section
            class="bg-gradient-to-r from-pink-900 to-pink-700 text-white py-12"
        >
            <div class="container mx-auto px-4">
                <h1 class="text-3xl md:text-4xl font-bold text-center">
                    الرسائل
                </h1>
                <p class="text-pink-100 text-center text-lg mt-2">
                    تواصل مع الأشخاص الذين أعجبوا بك
                </p>
            </div>
        </section>

        <!-- Top Banner Ad -->
        <section class="bg-gray-50 py-4">
            <div class="container mx-auto px-4">
                <AdUnit
                    slot={ANALYTICS_CONFIG.adsense.slots.homepageTop}
                    format="horizontal"
                    responsive={true}
                    className="messages-top-banner"
                />
            </div>
        </section>

        <!-- Messages Section -->
        <section class="py-8">
            <div class="container mx-auto px-4">
                <div class="flex flex-col lg:flex-row gap-6">
                    <!-- Main Messages Area -->
                    <div class="flex-1">
                        <div
                            class="bg-white rounded-2xl shadow-lg overflow-hidden flex flex-col"
                            style="height: calc(100vh - 400px); min-height: 600px;"
                        >
                            <MessagesApp client:only="svelte" />
                        </div>
                    </div>

                    <!-- Sidebar Ad (Desktop Only) -->
                    <aside class="hidden lg:block lg:w-80 flex-shrink-0">
                        <div class="sticky top-24">
                            <AdUnit
                                slot={ANALYTICS_CONFIG.adsense.slots
                                    .messagesTop}
                                format="vertical"
                                className="sidebar-ad"
                            />
                        </div>
                    </aside>
                </div>

                <!-- Bottom Banner Ad (Desktop/Tablet) -->
                <div class="hidden lg:block mt-6">
                    <AdUnit
                        slot={ANALYTICS_CONFIG.adsense.slots.homepageFooter}
                        format="horizontal"
                        responsive={true}
                        className="messages-bottom-banner"
                    />
                </div>

                <!-- Bottom Sticky Ad (Mobile Only) -->
                <DismissableAd
                    slot={ANALYTICS_CONFIG.adsense.slots.messagesTop}
                    format="horizontal"
                    className="lg:hidden fixed bottom-0 left-0 right-0 z-40 mobile-sticky-ad"
                    client:load
                />
            </div>
        </section>
    </main>

    <style>
        /* Sidebar ad styling */
        :global(.sidebar-ad) {
            margin: 0;
        }

        /* Mobile sticky ad styling */
        :global(.mobile-sticky-ad) {
            margin: 0;
            padding: 0.5rem;
        }

        /* Ensure mobile sticky ad doesn't overlap content */
        @media (max-width: 1023px) {
            main {
                padding-bottom: 120px;
            }
        }
    </style>

    <Footer />
</Layout>
