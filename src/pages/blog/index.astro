---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/common/Header.astro';
import Footer from '../../components/common/Footer.astro';
import { getCollection } from 'astro:content';
import { SITE_CONFIG } from '../../config';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Layout title={`المدونة | ${SITE_CONFIG.name}`}>
	<Header />
	<main class="container mx-auto px-4 py-12">
		<h1 class="text-4xl font-bold mb-8 text-teal-900 text-center">مقالات الهجرة والحياة</h1>
		<p class="text-center text-gray-600 mb-12 max-w-2xl mx-auto">
			اكتشف أحدث المعلومات والنصائح حول الهجرة، العمل، والحياة في الخارج.
		</p>

		<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
			{posts.map((post) => (
				<article class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow">
					<a href={`/blog/${post.slug}`}>
						{post.data.heroImage && (
							<img 
								src={post.data.heroImage} 
								alt={post.data.title} 
								class="w-full h-40 object-cover"
							/>
						)}
						<div class="p-6">
							<div class="flex gap-2 mb-3">
								{post.data.tags.map(tag => (
									<span class="text-xs bg-teal-50 text-teal-700 px-2 py-1 rounded-full">
										{tag}
									</span>
								))}
							</div>
							<h2 class="text-xl font-bold mb-2 text-gray-900 line-clamp-2">
								{post.data.title}
							</h2>
							<p class="text-gray-600 text-sm mb-4 line-clamp-3">
								{post.data.description}
							</p>
							<div class="flex items-center justify-between text-sm text-gray-500">
								<span>{post.data.author}</span>
								<time datetime={post.data.pubDate.toISOString()}>
									{post.data.pubDate.toLocaleDateString('ar-EG', {
										year: 'numeric',
										month: 'long',
										day: 'numeric',
									})}
								</time>
							</div>
						</div>
					</a>
				</article>
			))}
		</div>
	</main>

	<Footer />
</Layout>
