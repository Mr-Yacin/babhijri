---
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/common/Header.astro";
import Footer from "../../components/common/Footer.astro";
import { getCollection } from "astro:content";
import { SITE_CONFIG } from "../../config";

const posts = (await getCollection("blog")).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<Layout title={`المدونة | ${SITE_CONFIG.name}`}>
	<Header />

	<main class="min-h-screen bg-gray-50">
		<!-- Page Header -->
		<section
			class="bg-gradient-to-r from-teal-900 to-teal-700 text-white py-16"
		>
			<div class="container mx-auto px-4">
				<h1 class="text-4xl md:text-5xl font-bold mb-4 text-center">
					مقالات الهجرة والحياة
				</h1>
				<p class="text-teal-100 text-center text-lg max-w-2xl mx-auto">
					اكتشف أحدث المعلومات والنصائح حول الهجرة، العمل، والحياة في
					الخارج
				</p>
			</div>
		</section>

		<!-- Blog Posts Grid -->
		<section class="py-12">
			<div class="container mx-auto px-4">
				<div
					class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
				>
					{
						posts.map((post) => (
							<article class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-lg transition-all duration-300 hover:-translate-y-1">
								<a href={`/blog/${post.slug}`} class="block">
									{post.data.heroImage && (
										<img
											src={post.data.heroImage}
											alt={post.data.title}
											class="w-full h-48 object-cover"
										/>
									)}
									<div class="p-6">
										<div class="flex gap-2 mb-3 flex-wrap">
											{post.data.tags.map((tag) => (
												<span class="text-xs bg-teal-50 text-teal-700 px-3 py-1 rounded-full font-medium">
													{tag}
												</span>
											))}
										</div>
										<h2 class="text-xl font-bold mb-3 text-gray-900 line-clamp-2 leading-tight">
											{post.data.title}
										</h2>
										<p class="text-gray-600 text-sm mb-4 line-clamp-3 leading-relaxed">
											{post.data.description}
										</p>
										<div class="flex items-center justify-between text-sm text-gray-500 pt-4 border-t border-gray-100">
											<span class="font-medium">
												{post.data.author}
											</span>
											<time
												datetime={post.data.pubDate.toISOString()}
											>
												{post.data.pubDate.toLocaleDateString(
													"ar-EG",
													{
														year: "numeric",
														month: "long",
														day: "numeric",
													},
												)}
											</time>
										</div>
									</div>
								</a>
							</article>
						))
					}
				</div>

				{
					posts.length === 0 && (
						<div class="text-center py-12">
							<p class="text-gray-500 text-lg">
								لا توجد مقالات متاحة حالياً
							</p>
						</div>
					)
				}
			</div>
		</section>
	</main>

	<Footer />
</Layout>
